# Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Введение

Перед выполнением задания вы можете ознакомиться с [дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/master/additional/README.md).

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

* Электронные чеки в json виде
* Склады и автомобильные дороги для логистической компании
* Генеалогические деревья
* Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
* Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

```
> Ответ:
* Электронные чеки в json виде - документоориентированная база данных. MongoDB например. Основная направленность - хранение документов, поиск в документе(части документа), поиск без полной загрузки этих документов в память.
* Склады и автомобильные дороги для логистической компании - графовые бд, т.к сделать вопрос о поиске оптимальных маршрутов.
* Генеалогические деревья - иерархиические базы данных, где есть строгая иерархия - предок-потомок.
* Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации - REDIS, т.к необходимо хранение в памяти с ограниченнным временем жизни.  
* Отношения клиент-покупка для интернет-магазина - обычные базы данных, на примере Mysql,Postgres. Т.к необходимо хранить пользователя, заказ, товары и все связки.
```

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если (каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

* Данные записываются на все узлы с задержкой до часа (асинхронная запись)
* При сетевых сбоях, система может разделиться на 2 раздельных кластера
* Система может не прислать корректный ответ или сбросить соединение

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

```
PA-ELPA-EL
| Пункт        | CAP           | PACELC  |
| ------------- |:-------------:| -----:|
| Данные записываются на все узлы с задержкой до часа (асинхронная запись)      | CA | было - PA-EL, корректно EL-PC |
| При сетевых сбоях, система может разделиться на 2 раздельных кластера      | AP      |  было PA-EC, корректно  PA-EL |
| Система может не прислать корректный ответ или сбросить соединение | CP      |    было PA-EC, корректно PA-EC |

Доработка, с точки зрения PACELC не был корректно дан ответ.

С точки зрения CAP, данные корректно.

```



Update от куратора:

Добрый день!

Я бы расположил состояния таким образом:

1. AP - т.к. мы получаем данные и единственная проблема - это задержка.
   (Return the most recent version of the data you have, which could be stale)

CA - если у нас произошёл развал на кластеры, то это точно не P.
Такая ситуация получается, когда данные во всех узлах кластера согласованы и доступны, но не устойчивы к разделению. Это означает, что реплики одной и той же информации, распределенные по разным серверам друг другу, не противоречат друг другу и любой запрос к распределённой системе завершается корректным откликом.
К сожалению, могу согласиться, что конкретно в этом пункте могут быть разночтения. Например, вполне возможно, что CAP-теорема тут может быть вообще "не применима". Напомню, что в ней говорится лишь о максимально возможном количестве состояний (два из трёх), но это не отрицает отсутствия двух или всех трёх свойств.

CP - есть проблемы с ответом, либо возникают ошибки
(Wait for a response from the partitioned node which could result in a timeout error)
https://robertgreiner.com/cap-theorem-revisited/



## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

```
> Ответ:Нет. Это разные подходы

Традиционные СУБД ориентируются на требования ACID к транзакционной системе: атомарность (англ. atomicity), согласованность (англ. consistency), изолированность (англ. isolation), долговечность (англ. durability), тогда как в NoSQL вместо ACID может рассматриваться набор свойств BASE:

базовая доступность (англ. basic availability) — каждый запрос гарантированно завершается (успешно или безуспешно).
гибкое состояние (англ. soft state) — состояние системы может изменяться со временем, даже без ввода новых данных, для достижения согласования данных.
согласованность в конечном счёте (англ. eventual consistency) — данные могут быть некоторое время рассогласованы, но приходят к согласованию через некоторое время.

```

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

* фиксация некоторых значений с временем жизни
* реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). Что это за система? Какие минусы выбора данной системы?

```
> Ответ: Redis - наиболее популярная система ключ-значение. 
Минусы:
- Хранение в оперативной памяти, из коробки сохранение на жесткий нет. В это время может быть лаг (пара тройка секунд). Так же все хранится в оперативки, не всегда этот ресурс в достатке и дешев.
- Ресурс оперативки необходимо ограничивать сверху в конфиге. Может быть ситуация, когда оперативка и процессор уходит в запределельные дали.
- Нет языка запросов, но обертки языка это решают в целом. Из консоли это просто команды get - set
- 1 ядро-1 процессор. Маштабирования нет, т.е 1 экземпляр решает свои задачи и не более.

```

---

### Как cдавать задание

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.
